<html>
<head>
<title>Arch Linux Install</title>
<meta charset="utf-8">
<meta name="author" content="benny\">
<meta name="description" content="[Arch Linux Install] Arch Linux Install on VirtualBox with EFI & i3 #linux">
<link href="https://fonts.googleapis.com/css?family=Orbitron&display=swap" rel="stylesheet">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script>
$(document).ready( function () { 
    $("div.innerContent a:not([href*=bennybackslash]").click(function () { 
        $(this).attr('target','_blank');
    });
});
</script>        
<style>
body {
    background-color: #F0F0F0;
    }        
.innerContent {
    --main-text: #181818;
    --ref-text: #484848;
    --link-text: #EE1515;
    --link-hover: #181818;
    --background: #F0F0F0;
    background-color: var(--background);
    font-family: sans-serif;
    margin: 10px;
    }        
.innerContent p {
    clear: both;
    }        
.innerContent a:link {
    color: var(--link-text);
    background-color: transparent;
    text-decoration: none;
    }        
.innerContent a:visited {
    color: var(--link-text);
    background-color: transparent;
    text-decoration: none;
    }        
.innerContent a:hover {
    color: var(--link-hover);
    background-color: transparent;
    text-decoration: underline;
    }        
.innerContent a:active {
    color: var(--link-text);
    background-color: transparent;
    text-decoration: underline;
    }        
.innerContent pre {
    overflow-x: auto;
    white-space: pre-wrap;
    white-space: -moz-pre-wrap;
    white-space: -pre-wrap;
    white-space: -o-pre-wrap;
    word-wrap: break-word;
    }        
.innerContent code {
    background-color: white;
    border: 1px solid #181818;
    display: block;
    padding: 20px;
    }        
.innerContent table {
    border-collapse: collapse;
    margin-top: 15px;
    margin-bottom: 15px;
    }        
.innerContent table,.innerContent th,.innerContent td {
    border: 1px solid black;
    }        
.innerContent th,.innerContent td {
    padding-left: 15px;
    padding-right: 15px;
    padding-top: 5px;
    padding-bottom: 5px;
    }        
.minilogo{
    display: inline-block;
    color: var(--main-text);
    font-family: 'Orbitron', sans-serif;
    font-size: 26;
    margin-left: 1%;
    }    
</style>
</head>
<body>
<div class="innerContent">
<script>
if (window.location.href.indexOf("posts") > -1) { 
    $('.returnLink').css('display','inline-block');
}
else {
    $('.returnLink').css('visibility','none');
}
</script>        
<div class="returnLink" style="float:right;">
<a href="https://bennybackslash.github.io/#Welcome" style="text-decoration: none;"><div class="minilogo">benny\</div></a>
</div>
<div class="shareButton" style="float:right;">
<a href="https://www.facebook.com/sharer.php?u=https://bennybackslash.github.io/posts/Arch%20Linux%20Install.html" target="_blank"><img src="https://bennybackslash.github.io/images/facebook.jpg" style="height:32px;width:32px;margin-right:15px;"></a><a href="https://twitter.com/intent/tweet?url=https://bennybackslash.github.io/posts/Arch%20Linux%20Install.html" target="_blank"><img src="https://bennybackslash.github.io/images/twitter.jpg" style="height:32px;width:32px;margin-right:15px;"></a><a href="https://reddit.com/submit?url=https://bennybackslash.github.io/posts/Arch%20Linux%20Install.html" target="_blank"><img src="https://bennybackslash.github.io/images/reddit.jpg" style="height:32px;width:32px;margin-right:15px;"></a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https://bennybackslash.github.io/posts/Arch%20Linux%20Install.html" target="_blank"><img src="https://bennybackslash.github.io/images/linkedin.jpg" style="height:32px;width:32px;margin-right:15px;"></a></div>
<h1>Arch Linux Install - VirtualBox/EFI/i3</h1>
<p>This is a simplified guide to installing a minimal version of Arch on VirtualBox with i3 using an EFI bootloader.</p>
<p>Do your best to simply follow the <a href="https://wiki.archlinux.org/index.php/installation_guide">installation guide</a> on the Arch Wiki (and other Arch Wiki pages). Everyone in the community is just going to point you back there anyways - a splendid group I tell ya. Learn, embrace, and submit to the Arch install.</p>
<ol>
<li>
<p>Download latest Arch ISO from one of the mirrors <a href="https://www.archlinux.org/download/">here</a>.</p>
<ul>
<li>If you are on Windows, then you can verify the signature using <a href="https://www.gpg4win.org">Gpg4win</a>.</li>
</ul>
</li>
<li>
<p>Setup your virtual machine.</p>
<ul>
<li>
<p>Make sure you have the latest version of VirtualBox on your host. Arch will have the latest and if there is a version mismatch, then it can cause issues. Also, download the extension pack if you want USB 2.0 support.</p>
</li>
<li>
<p>Set name, memory, storage, and other settings as you see fit. I typically dedicate half of my system memory and processors, use a dynamically allocated drive with a generous amount of space (~50 GB), max out the video memory, enable 3D acceleration, set the Shared Clipboard and Drag'n'Drop to Bidirectional, and enable USB 2.0 (again, this requires the extension pack).</p>
</li>
<li>
<p>Check the Enable EFI (special OSes only) box in the System tab.</p>
</li>
</ul>
<p><img alt="" src="https://bennybackslash.github.io/images/vbox_efi.PNG" /></p>
<ul>
<li>Run machine and select downloaded ISO when prompted. SHA256 validated screen sticks for a bit.</li>
</ul>
</li>
<li>
<p>For non-US users, set the keyboard layout.</p>
<ul>
<li>List available layouts:</li>
</ul>
<p><code># ls /usr/share/kbd/keymaps/**/*.map.gz</code></p>
<ul>
<li>Example of setting layout for Germany:</li>
</ul>
<p><code># loadkeys de-latin1</code></p>
</li>
<li>
<p>Verify the boot mode (this should spit out a list).</p>
<p><code># ls /sys/firmware/efi/efivars</code></p>
</li>
<li>
<p>Verify internet connection.</p>
<ul>
<li>List network interfaces - make note of the interface name (e.g., enp0s3):</li>
</ul>
<p><code># ip link</code></p>
<ul>
<li>Ping a website to test connection:</li>
</ul>
<p><code># ping -c1 archlinux.org</code></p>
</li>
<li>
<p>Update the system clock.</p>
<p><code># timedatectl set-ntp true</code></p>
</li>
<li>
<p>Partition Drive</p>
<ul>
<li>List drives (generally looking for sd#, where '#' is a given letter, replace '#' in the commands below as required):  </li>
</ul>
<p><code># ls /dev</code></p>
<ul>
<li>Use gdisk to partition drive:  </li>
</ul>
<p><code># gdisk /dev/sda</code></p>
<ul>
<li>Table of common settings I use for partition drives:</li>
</ul>
<table>
<thead>
<tr>
<th>Partition Drive</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>BIOS</td>
<td>Bootloader, +10MB, EF02</td>
</tr>
<tr>
<td>EFI</td>
<td>Bootloader, +500MB, EF00</td>
</tr>
<tr>
<td>swap</td>
<td>+2GB, 8200</td>
</tr>
<tr>
<td>root</td>
<td>System Files, +15GB (Minimum), 8300</td>
</tr>
<tr>
<td>home</td>
<td>Personal Files, Remaining Space, 8300</td>
</tr>
</tbody>
</table>
<ul>
<li>Setup your partitions:<pre><code>// EFI BOOT PARTITION
# p
::RETURN::
# n
::RETURN::
::RETURN::
::RETURN::
# +500M
::RETURN::
# EF00
::RETURN::

// SWAP PARTITION
# n
::RETURN::
::RETURN::
::RETURN::
# +2G
::RETURN::
# 8200
::RETURN::

// ROOT PARTITION
# n
::RETURN::
::RETURN::
::RETURN::
# +15G
::RETURN::
::RETURN::

// HOME PARTITION
# n
::RETURN::
::RETURN::
::RETURN::
::RETURN::
::RETURN::

// CREATE PARTITIONS
# p
::RETURN::
// NOTE WHAT PARTITION NUMBERS CORRESPOND TO WHAT PARTITIONS FOR FORMATTING
w
::RETURN::
y
::RETURN::
</code></pre>
</li>
</ul>
</li>
<li>
<p>Format Partitions (remember to update drive letter and partition number as necessary).</p>
<pre><code>// EFI BOOTLOADER PARTITION
# mkfs.fat -F32 /dev/sda1

// SWAP PARTITION
# mkswap /dev/sda2

// ROOT PARTITION
# mkfs.ext4 /dev/sda3

// HOME PARTITION
# mkfs.ext4 /dev/sda4
</code></pre>
</li>
<li>
<p>Mount Partitions (remember to update drive letter and partition number as necessary).</p>
<pre><code>// TURN SWAP ON
# swapon /dev/sda2

// MOUNT ROOT
# mount /dev/sda3 /mnt

// CD INTO /MNT
# cd /mnt

// CREATE BOOT AND HOME DIRECTORIES
# mkdir boot home

// MOUNT BOOT
# mount /dev/sda1 boot

// MOUNT HOME
# mount /dev/sda4 home
</code></pre>
</li>
<li>
<p>Install Arch (If you forget something, then you can chroot back in)</p>
<p><code># pacstrap /mnt base base-devel linux linux-firmware vim rxvt-unicode firefox thunar xorg-server xorg-xinit i3 dmenu grub efibootmgr netctl wpa_supplicant dhcpcd dialog ttf-dejavu virtualbox-guest-modules-arch virtualbox-guest-utils xf86-video-vmware mousepad</code></p>
</li>
<li>
<p>Generate fstab file</p>
<p><code># genfstab -U /mnt &gt;&gt; /mnt/etc/fstab</code></p>
</li>
<li>
<p>chroot into system</p>
<p><code># arch-chroot /mnt</code></p>
</li>
<li>
<p>Set Timezone</p>
<pre><code># ln -sf /usr/share/zoneinfo/America/New_York /etc/localtime
# hwclock --systohc
</code></pre>
</li>
<li>
<p>Localization</p>
<ul>
<li>Uncomment "en_US" locales in /etc/locale.gen</li>
</ul>
<p><code># vim /etc/locale.gen</code></p>
<ul>
<li>Generate locales</li>
</ul>
<p><code># locale-gen</code></p>
<ul>
<li>Set locale language (add LANG=en_US.UTF-8 to file below)</li>
</ul>
<p><code># vim /etc/locale.conf</code></p>
</li>
<li>
<p>Set root password</p>
<p><code># passwd</code></p>
</li>
<li>
<p>Add another user and adjust privileges</p>
<pre><code># useradd --home-dir /home/benny --create-home benny
# passwd benny
// ADD "benny ALL=(ALL) ALL" UNDER "root ALL=(ALL) ALL"
# vim /etc/sudoers
</code></pre>
</li>
<li>
<p>Setup internet and virtual box services</p>
<ul>
<li>Internet (replace enp0s3 as necessary - see Step 5).</li>
</ul>
<p><code># systemctl enable dhcpcd@enp0s3.service</code></p>
<ul>
<li>Virtual box (auto-load vbox modules)<pre><code># vim /etc/modules-load.d/virtualbox.conf
// ADD LINES
vboxguest
vboxsf
vboxvideo
# systemctl enable vboxservice.service
</code></pre>
</li>
</ul>
</li>
<li>
<p>Install &amp; Configure GRUB</p>
<pre><code># grub-install --target=x86_64-efi --efi-directory=/boot --bootloader-id=GRUB --removable
# grub-mkconfig -o /boot/grub/grub.cfg
</code></pre>
</li>
<li>
<p>Shutdown virtual machine, remove ISO file from the Storage tab in Settings, and restart.</p>
</li>
<li>
<p>Login an non-root user</p>
<pre><code># echo "exec i3" &gt; ~/.xinitrc
# startx
</code></pre>
</li>
</ol>
<p>References:</p>
<ul>
<li>
<p>Arch Wiki - Installation Guide: <a href="https://wiki.archlinux.org/index.php/installation_guide">https://wiki.archlinux.org/index.php/installation_guide</a></p>
</li>
<li>
<p>GRUB Reference: <a href="https://wiki.archlinux.org/index.php/GRUB">https://wiki.archlinux.org/index.php/GRUB</a></p>
</li>
<li>
<p>Virtualbox Reference: <a href="https://wiki.archlinux.org/index.php/VirtualBox">https://wiki.archlinux.org/index.php/VirtualBox</a></p>
</li>
<li>
<p>Decent Arch Install Guide: <a href="https://dev.to/siatwe/install-a-minimal-arch-linux-in-half-an-hour--1l6p">https://dev.to/siatwe/install-a-minimal-arch-linux-in-half-an-hour--1l6p</a></p>
</li>
<li>
<p>Another Decent Arch Install Guide: <a href="https://wideaperture.net/blog/?p=4503">https://wideaperture.net/blog/?p=4503</a></p>
</li>
</ul>
<p>Random Tips:</p>
<p>The command below installs and overwrites all files (be careful). This has helped me out when I've messed up an install before.</p>
<p><code># pacman -S package --overwrite='*'</code></p>
<p>If you land in grub after install, then use the ls command to check filenames. I've had to point to the config file before.</p>
<p><code>grub&gt; configfile (hd1,gpt1)/boot/grub/grub.cfg.new</code></p>
<div id="disqus_thread"></div>
<script>
var disqus_config = function ()
{
this.page.url = 'https://bennybackslash.github.io/posts/Arch Linux Install.html';
this.page.identifier ='636b4c40ea15e3a129bf6c0609cf2c2c';
};
(function() { 
var d = document, s = d.createElement('script');
s.src = 'https://bennybackslash.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<script>
$('img:not(.indexImage, .dividerImage, .socialImage)').each(function (index, element) { 
    $.get($(element).attr('src'), function (data) { 
        $(element).attr('src', 'data:image/png;base64,' + data); 
    });
});
</script>        
</div>
</body>
</html>
